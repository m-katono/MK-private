<!DOCTYPE html>
<html lang="ja" dir="ltr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
<!--スタイルシートを読み込み-->
<link rel="stylesheet" href="./css/master.css" type="text/css">
<link rel="stylesheet" href="./css/menu.css" type="text/css">
        <title>MK-private</title>
    </head>
    <body>
	    <!--  浮いてるメニュー  -->                                    
	    <div class="top_menu">
		<a href="#top" class="pagenum">top</a>-<a href="./top.html#menu" class="pagenum">menu</a>
	    </div>

        <div class="top">
		<p><iframe width="400" height="30" frameborder="0"></iframe></p>
<!--ここから記事-->
<!--ラズパイzeroの準備-->
            <div class="menu" id="i2">
            <h3>#2-Raspberrypi zero whの準備</h3>24/Jan/2020
            <p>
            　Raspberrypi zero whはネットショッピングで購入した。GPIOピンが半田付け済みで16GBのマイクロSDカードがセットになったやつにした。（→<a href="https://www.amazon.co.jp/Raspberry-GPIO%E3%83%94%E3%83%B3%E3%83%98%E3%83%83%E3%83%80%E3%83%BC-%E3%83%8F%E3%83%B3%E3%83%80%E4%BB%98%E3%81%91%E6%B8%88%E3%81%BF-Wi-Fi-Bluetooth%E4%BD%9C%E5%8B%95%E7%A2%BA%E8%AA%8D%E6%B8%88%EF%BC%88%E3%83%92%E3%83%BC%E3%83%88%E3%82%B7%E3%83%B3%E3%82%AF%E3%80%81%EF%BC%B3%EF%BC%A4%E3%82%AB%E3%83%BC%E3%83%89%E4%BB%98%E3%81%8D/dp/B07PHPK8CP/ref=sr_1_1?__mk_ja_JP=%E3%82%AB%E3%82%BF%E3%82%AB%E3%83%8A&keywords=raspberry+pi+zero+wh&qid=1579869523&sr=8-1" target="_blank" rel="noopener">こんなやつ</a>）    GUI環境だとマシンスペックが不足だしどうせターミナルばっかり使うのでCUIのみの「Lite」にした。付属のSDカードにはNOOBSというインストーラーが入っていたが、容量がもったいないので消した。不要な物は無い方が気分が良い。モニターとキーボードを繋がずにセットアップするには下準備がいくつか必要になるが今回は割愛する。なんとなくの流れは「OSイメージを<a href="https://www.raspberrypi.org/downloads/raspbian/" target="_blank" rel="noopener">ダウンロード</a>→SDカードをフォーマット→ddコマンドでOSイメージを書き込む→.sshディレクトリを作る→Wi-Fiの接続設定を書き込む」までやってからラズパイにSDカードを差して起動し、SSHで他のPCから初期設定する。日本語フォントを入れたりもする。
            <pre class="coding-env"><code>
$sudo apt install apache2
            </code></pre>

            　Webサーバーは定番のApache2をインストールした。/etc/apache2/apache2.confの中のディレクトリのアクセス制限をググった情報を元に書き足したりしたが、ほとんどそのままで大丈夫そうだった。cgiを使う時にはちょっと変更が必要そう。
            </p>
            <p>
            　忘れないようにこの段階でファイアーウォールの設定をしておく。ufwが簡単そうだったのでインストールした。<br>
            <pre class="coding-env"><coke>
$sudo apt install ufw
$sudo ufw allow '許可するポートの番号'
$sudo ufw status
        </code></pre>
            みたいな感じ。ルーターの方のポート開放もしないとWAN側からアクセスできないので必ず設定しておく。自分の学習用のサイトなのでずっとIPアドレスでアクセスしていても良かったが、DNSというのも使ってみたくなってMyDNSを利用することにした。登録は思ったよりも簡単で、一通りの設定を終えたらすぐにドメイン名でアクセスできるようになった。ちょっと感動。<br>
            　動的なグローバルIPアドレスは不意にアドレスが変わってしまうことがあるので、いつでもアクセスできるようにするには別途対策が必要。あとでIPアドレスをMyDNSに通知するシェルスクリプトを作ってcronに登録しておこうと思う。
            </p>
            <a href="https://www.mydns.jp/" taget="_blank" rel="noopener">MyDNSのサイト</a><br>
	    <br>
            </div>
	</div>
    </body>
</html>
