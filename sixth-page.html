<!DOCTYPE html>
<html lang="ja" dir="ltr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="./css/master.css" type="text/css">
        <title>MK-private</title>
    </head>
    <body>
<!--  浮いてるメニュー  -->
<div class="top_menu" id="i30">
        <a href="#top" class="pagenum">top</a>-<a href="./index.html#menu" class="pagenum">menu</a>
</div>

        <div class="top" id="top">

		<p><iframe width="400" height="30" frameborder="0"></iframe></p>

            <h1><a href="https://shangyuanyezhengju.wixsite.com/mkpage" target="_blank" rel="noopener"><img src="./photo/icon.jpg" alt="" width="40px" height="40px"></a><a href="https://m-katono.mydns.jp">MK-private</a></h1>
            <div class="menu"><h2>Page 6</h2>
            Page-<a href="./index.html#menu" class="pagenum">menu</a>-<a href="./index.html" class="pagenum">1</a>-<a href="./second-page.html" class=pagenum>2</a>-<a href="./third-page.html" class="pagenum">3</a>-<a href="./fourth-page.html" class="pagenum">4</a>-<a href="./fifth-page.html" class="pagenum">5</a>-6-
            <p>
                　MarkDownからhtmlへ変換すると余計なタグがたくさん混じって見づらいのでやめた。
            </p>
            </div>
            <div class="menu" id="i26">
                <h3>外付けHDD（1TB）を買った</h3>20/Mar/2020
                <p>
                    　先日までRaspberry pi 3B+に取り付けていたUSBバスパワーのHDDが使えなくなったため64GBのUSBメモリで代用していたが耐久性に不安がある気がしていた。そこでヤ◯オクで外部電源のHDDを買うことにした。中古だと安い金額でたくさんの商品が出品されているので迷ってしまうが、今後の耐用年数を考慮して使用時間が少ないものを選んだ。
                    <ul>
                        <a href="https://www.elecom.co.jp/products/ELD-CED010UWH.html" target="_blank" oncontextmenu="noopener"><h4>ELECOM ELD-CED010UWH</h4></a>
                        <li>買ったのはホワイト。在庫限りらしい。</li>
                        <li>定価は税込み¥12,980-</li>
                        <li>購入価格は¥3,000-</li>
                        <li>使用時間は299時間</li>
                        <li>USB3.0、1TB。</li>
                    </ul>
                    最近は2TB以上のモデルが主流で、1TB以下のものはかなりお買い得になっているらしい。
                </p>
                <p>
                    　そんなに古い商品ではないので接続すればすぐに使えると思っていたが、予想外に苦労したので備忘録として記録しておく。
                </p>
                    <ol>
                        <li>はじめにDELLのInspiron 3162(Ubuntu18.04)に繋いでみた。
                            <ul>
                                <li>自動認識はしない。</li>
                                <li><code class="coding-env">fdisk -l</code>や<code class="coding-env">df</code>コマンドでは出てこないみたい。</li>
                                <li><code class="coding-env">lsusb</code>にはELECOMなんとかって出てくる。</li>
                            </ul>
                        </li>
                        <li>テレビ（東芝REGZA）に繋いでみた。
                            <ul>
                                <li>「初期化しますか？」的なメニューが表示されるので認識しているみたい。</li>
                            </ul>
                        </li>
                        <li>NEC VersaPro(Windows10)に繋いでみた。
                            <ul>
                                <li>ドライブ一覧には表示されていない。</li>
                                <li>デバイスドライバでは「USB大容量記憶装置」として認識されている。</li>
                                <li>「ディスクの管理」で見るとやっと見えた。３つのパーティションに分かれているみたい。</li>
                            </ul>
                        </li>
                    </ol>
                <p>
                    　「ディスクの管理」でパーティションが見えたので、そのまま全部消して新しくNTFSのパーティションを作成したところ、ドライブ一覧にも表示された。どうやらテレビ用のファイルシステムはパソコンでうまく認識できないらしい。今度はUbuntu PCで改めてパーティションを作り直そうとしたが、別の問題が発生した。USB3.0ポートに繋いだところマウントしたりアンマウントしたりを何度も繰り返して、最終的にはHDDの電源が落ちた。どうやら相性の問題らしくUSB2.0ポートに繋いだら正常に認識したので、やっとext4でパーティションを作成しなおしてRaspberry pi 3B+で動作させることができた。
                </p>
                <p>
                    　今回は自分の知識不足で余計な時間をかけてしまったが、ディスク管理関係のコマンドを何回も使ったので勉強になった。特に、今までは<code class="coding-env">fdisk</code>しか使っていなかったが<code class="coding-env">parted</code>コマンドを使ってみたらとても使いやすかった。
                </p>
            </div>

            <div class="menu" id="i27">
                <h3>ArchLinux をインストール</h3>19/Dec/2020
                <p>（＊ここではインストール方法は説明しないが、参考にしたサイトを紹介したり感想をかいたりする。）
                </p>

                <h4>なぜArchLinuxか</h4>
                <p>　MacOSを使ってみたくてしばらくはMacBookAir(2011 Mid)を使用していたが、思ったほど快適ではなかったので売ってしまった。Windowsよりは自由度が高いような気がするし、オシャレなので嫌いではなかった。でも普段からUbuntuを使っているとLinuxのほうが分かりやすいし、動作が軽い気がして好きだ。主にDellの安いラップトップにUbuntuを入れて使っていたが、低スペック(Celeron N3060, DDR3L-4GB)なのであまり重い作業はできないし、購入から１年でストレージ(32GB-eMMC)の90%が埋まってしまって限界が近くなっていた。
                </p>
                <p>　最近はPuppyLinuxやRaspberryPiOSなんかをよく使うのでOSのインストールには慣れていたし、いっそうのことリフレッシュしようと思ってLinuxMint(MATE)を入れてみた。Ubuntuよりも軽快だし、良い意味で「普通」に動く。が、Ubuntuを使っていたときと同等の環境を作るとストレージの半分以上が埋まってしまった。
                </p>
                <p>　動作に関してはPuppyが最軽量だと思うが、ちょっと特殊なので使用用途を選ぶ感じがする。Puppyに匹敵するくらい快適に動作するディストリビューションはないものかと思ってネットを徘徊していると、ArchLinuxというのに行き着いた。なんでも、中・上級者向けだとか、インストーラーが無いだとか、自分好みの環境を作れるとかでとても魅力的に感じた。自分のスキルでは不足していると思ったが、解説してくれているサイトがいくつかあるし、公式ドキュメントが充実しているのでなんとかなるんじゃないかと思ってインストールすることにした。
                </p>

                <h4>インストール</h4>
                　インストールするにあたって、主に２つのサイトを参考にさせていただいた。まずは最小限の構成でインストールしてから後でデスクトップ環境を整えるという順番で、できるだけ新しい記事を参考に進め、他にもいろいろなサイトを見ながら、自分に必要なところだけ組み合わせてインストールした。
                <ul>
                    <li><a href="https://qiita.com/TsutomuNakamura/items/b60518f8788e5e998744" target="_blank" oncontextmenu="noopener">https://qiita.com/TsutomuNakamura/items/b60518f8788e5e998744</a>(Arch Linux インストール俺々式完全版)</li>
                    <li><a href="https://qiita.com/j8takagi/items/235e4ae484e8c587ca92" target="_blank" oncontextmenu="noopener">https://qiita.com/j8takagi/items/235e4ae484e8c587ca92</a>(Arch Linuxの最小限インストール)</li>
                </ul>
まずは他のディストリビューションと同じで<a href="https://www.archlinux.jp/download/" target="_blank" oncontextmenu="noopener">公式サイト</a>からイメージをダウンロードしてUSBメモリに書き込んで起動する。インストーラーが無いので順番にコマンドを打って実行していくが、焦らずに進めればそれほど難しくはなっかた。インストーラーがやっていることを手動で進めていくだけなので「何をするコマンドなのか」を考えながら進めれば迷うことはないが、インストールする環境によって少しずつ違うと思うので必ずエラーが出ると思う。エラーのコメントやログをじっくり読んで解決すればどうにかインストールできる感じ。大抵は「~~~ is not found」とかなので不足のパッケージを<code class="coding-env">pacman -S</code>でインストールすれば解決できることが多い。私の環境ではUSBメモリから起動してネットにつなぐのは問題なかったが、インストールコマンドを実行して<code class="coding-env">arch-chroot /mnt</code>した後に、新しい環境からインターネットに繋ごうとするとダメだった。dhcpcd が見つからないのが原因だったが、USBメモリの方には入っていたのにインストール後のArchLinuxにはdhcpcdが無いようで、すぐに気づくことができずにちょっとハマった。ちなみに、なるべく小さくまとめたかったのでデスクトップはXfce4にした。
                <h4>（今のところ）良かったこと</h4>
                <ol>
                    <li>とても勉強になった。普段GUIばかり使っていると諸々のプログラムがほとんど自動で動くので、Xwindowシステム、ネットワーク、bluetoothなどをCLIから手動で起動してみるとなんとなく仕組みがわかった気になる。</li>
                    <li>動作が軽い。OSの起動は電源ボタンを押してから15秒位でログイン画面まで進む。eMMCはHDDとそれはど速度が変わらないことを考えると、とても速い。</li>
                    <li>小さい。インストールイメージは600MBちょっと。CLI状態で2.5GBくらいだった気がする。デスクトップ環境、openJDK12、rust、IntelliJ IDEA、LibleOffice、Chromium、Thunderbird、その他のパッケージをインストールしても8.6GB。</li>
                    <li>ローリング・リリース。OSのバージョンなんか気にしなくていい。パッケージマネージャのPacmanも結構使いやすい。</li>
                </ol>
                <h4>気になるところ</h4>
                インストールしてすぐは、本当に最低限の環境だけ。ほしい機能があれば自分でパッケージをインストールしなければならない。Linuxのターミナルに慣れていれば全く苦にならないが、WindowsからいきなりArchLinuxに移行するのは不可能に近い。他のメジャーなディストロを経験してからチャレンジするべきと思われる。
        <br>
        <br>
        <img src="./photo/screen.png" alt="df -h" width="600px" oncontextmenu="return false;"><br>
        <img src="./photo/desktop.png" alt="desktop" width="600px" oncontextmenu="return false;"><br>
        <br>
<20/Dec/2020 追記>
        <p>　細かく必要そうなパッケージをダウンロードして現在は下の写真のスタイル。Xfce4にダークテーマがあったので変えてみた。右上のタスクバーに音量、Bluetooth、ネットワークのアイコンが追加されたので、使い勝手は他のディストリビューションと変わらない。今のところ動作が非常に安定していて不具合はないので、インストール作業に慣れれは自分にとってはベストチョイス。ただ、GUIインストーラーがあるManjoroもどんな感じか気になる。
        </p>
        <img src="./photo/os_version.jpg" alt="desktop_dark theme" width="600px" oncontextmenu="return false;"><br>
        使用にあたってのメモ<br>
        ネットワーク設定ツール > nmtui、nmcli<br>
        音量コントロール > alsamixer、もしくはGUI<br>
        パッケージの古いキャッシュを削除 > paccache -r<br>
        <br>
        <br>
        </div>

	<div class="menu" id="i28">
	<h3>GIGABYTE製のNUCを買う</h3>03/Jan/2021
	<p>
	　今使っているパソコンは安いノートPCを３つとラズパイが３つで、一番高性能なモデルでもCore i5-560Mという古いCPUを積んだもの。他は新しめのCeleronとAtomなのでちょっと動作がもっさりしているし、画面が小さくて目が疲れやすく感じる。ちなみにオンボードでメモリやCPUがついているので交換などはできないタイプ。とくにYouTUBEとかを見ていると表示に時間がかかるのでイライラする。
	</p>
	<p>
	　はじめは高性能系ノートPCの購入を考えたけど、ノートPCばかり４つもあっても無駄なので久しぶりにデスクトップPCの購入も考え始めた。かと言って昔みたいにタワー型のデカいやつは邪魔なのでなるべく小さくて安いやつを某オクで物色していると、intel、ASUS、GIGABYTEなんかのNUCが目に入った。Celeronモデルが多く出回っているが、中にはCore iシリーズ搭載モデルもあるみたい。この手のひらサイズのNUCをテレビに繋いでデスクトップPC化すればスペースが無駄にならないと思い、早速５人くらいと競り合って落札した。もともとはベアボーンキットだが、中古なのでメモリやSSDがついていてラッキー。ACアダプタはなかったが、手持ちのもので代用可能だった。<br>
	<ul>
		<li>GIGABYTE GB-BSi3H-6100</li>
		<li>CPU Core i3-6100U 2.3GHz</li>
		<li>RAM DDR3L-1600 16GB(Transcend製8GB*2)</li>
		<li>SSD Crucial MX300 525GB</li>
		<li>￥１４，３５５ー（税込み）</li>
	</ul>
	　M.2 SSDにも対応しているけど熱に弱そうなのであまり高性能化できない（多分ファンレス）。CPUもメモリも低電力タイプで発熱が少ないやつがついている。OSは付いていないのでWindows10を入れるつもりだったが、できるだけ軽いやつの方が幸せになれそうなので最近マイブーム（死語？）のArchLinuxとXfce4の組み合わせにした。ためしにYouTUBEを1080p全画面再生してみてもかなり余裕な感じで、さすがに安いノートPCとは全然違った。
	</p>
	<img src="./photo/htop.png" alt="CPU & RAM" width="600px" oncontextmenu="return false;"><br>
	<p>
	　ちなみに今まではハードオフのジャンクコーナーに売っていた５００円のキーボードを使っていたのだが、最近あまり調子が良くないのとデカすぎるので新調することに決めた。とはいえまた中古で物色したのだが、ずっと使ってみたかったPFUのHHKBシリーズを買うことにした。個人的にはあの独特のキー配置に興味があって、みんなが褒める打鍵感はどうでも良い。また某オクで検索していると、HHKB lite2（US配列）の未使用品なるものが出てきたので、こちらは３０００円で即決購入した。
	</p>
	</div>
	
	<div class="menu" id="i29">
		<h3>ArchLinuxのインストール手順　その１</h3>04/Jan/2021
		<p>
		　先日オークションで落札していたHHKBが今日の午前中に届いた。試しに繋いで使ってみたらとても良い感触で、何か文字入力をしたくなってしまった。最近は立て続けにArchLinuxをインストールしているが、まだ手順を覚えられないので調べながらやっている。人によって必要なパッケージが違ったりもして自分にとって不要な説明もあったりするので、この際だから自分流のインストール手順をメモっておくことにする。
		</p>
		<p>
		　まずは、Live起動用のUSBメモリを作成する。手元にあったTranscendの古い１GBがあったので、Ubuntuから<code class="coding-env">dd</code>コマンドで書き込んだ。サイズは600MBちょっとなのでダウンロードも書き込みもサクサク進む。<a href="https://www.archlinux.jp/download" target="_blank">JPサイト</a>からダウンロードするのがわかりやすいかもしれない。出来上がったUSBメモリをPCに挿して起動し、まずはキーボードの設定→インターネット接続→パーティション作成→フォーマット→マウントまで。
		</p>
		<pre class="coding-env"><code>
// 日本語キーボードの場合
# loadkeys jp106

// 今回はwi-fi環境
# ip link show		// インターフェース名を調べる
# ip link set wlan0 up	// インターフェースを有効に
# iwlist wlan0 scanning | grep SSID	// アクセスポイントを調べる

// 接続する。どこかにpingしてつながればOK。
# wpa_supplicant -B -i wlan0 -c <(wpa_passphrase ESSID PASSPHRASE)

// パーティション作成　＆　フォーマット
// まずはEFI System。partedコマンドのほうがスマートだったかも。。。
# fdisk -l		// インストールするディスクを間違えないように
# fdisk /dev/sda		// 今回はsdaだった
Command (m for help) : n	// 新規にパーティションを作成
Partition number : 1		// 1　もしくは　Enter
First sector :			// Enterで良い
Last sector : 512M		// 要100MiB以上
Do you want to remove the signature? : y

Command (m for help) : t	// Selected partition 1
Partition type (type L to list all types) : 1	// Changed type of partition 'Linux filesystem' to 'EFI System'.
Command (m for help) : w	// 書き込む

// その他はあんまり細かく分けたくない
# fdisk /dev/sda
Command (m for help) : n	// 新しいパーティション。Enterを押していけば良い。
Command (m for help) : w	// 書き込んで終了

// 作ったパーティションをフォーマット
# mkfs.fat -F32 /dev/sda1
# mkfs.ext4 /dev/sda2

// マウント
# mount /dev/sda2 /mnt
# mkdir /mnt/boot
# mount /dev/sda1 /mnt/boot
		</code></pre>
		<p>
		　ここからインストールに進む。pacman用にミラーの設定→システムクロック設定→baseパッケージをインストール。LiveUSB環境とインストール先の環境には結構違いがあり、セットアップに必要になりそうなパッケージはここでインストールしておいたほうが良さそう（dhcpcdやエディタなど）。
		</p>
		<pre class="coding-env"><code>
// /etc/pacman.d/mirrorlist を開き、日本のサーバーを上段に移動しておく。
// 時計を合わせる
# timedatectl set-ntp true

// baseパッケージをインストール
# pacstrap /mnt base base-devel linux linux-firmware vim git dhcpcd networkmanager wpa_supplicant grub efibootmgr

// fstabを作成。
# genfstab -U /mnt >> /mnt/etc/fstab

// ファイルシステムへ入る
# arch-chroot /mnt

// ここからは細かい設定
# ln -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime/	// タイムゾーンの設定
# hwclock --systohc --utc

# vim /etc/locale.gen	// ロケールの設定
     以下２つのコメントアウトを外す
     en_US.UTF-8 UTF-8
     ja_JP.UTF-8 UTF-8

# locale-gen		// ロケールを反映させる
# echo LANG=en_US.UTF-8 > /etc/locale.conf	// 今のところは英語にしておく
# echo KEYMAP=jp106 > /etc/vconsole.conf	// 日本語配列キーボードの場合

// ホストネームを設定
# echo foo > /etc/hostname
// /etc/hostsの中を編集
# vim /etc/hosts
     127.0.0.1 localhost
     ::1       localhost
     127.0.0.1 foo.localhdomain foo

// rootのパスワードを設定する
# passwd

// grubとEFIブートマネージャーをインストール
# grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=grub
# grub-mkconfig -o /boot/grub/grub.cfg

// ユーザーも作成しておく
# useradd -m -g wheel hoge	// wheelグループに入れておく
# passwd hoge		// パスワードを設定
# EDITOR=vim visudo	// sudoresファイルを編集
   以下をコメントアウト
   %wheel ALL=(ALL) ALL	// suduできるようになる

// chrootから抜けて再起動する。USBメモリは抜く。
# exit
# reboot
		</code></pre>
		<p>
		　一般ユーザーでログイン＆再度インターネットに接続できれば成功。USBで起動していたときとは環境が違うので、ワイヤレスデバイス名が違ったりパッケージが足りなかったりしてエラーが出るかもしれない。そのときは落ち着いてエラーを読んで対処すれば大丈夫だった。このあとはデスクトップ環境をインストールしたりその他の必要なソフトをインストールしたりするが、長くなったので次回に持ち越し。
		</p>
	</div>

    <div class="menu">

<h3>ArchLinuxのインストール手順　その２</h3>05/Jan/2021
<p>
　続いてデスクトップ環境をインストールしていく。余計な機能が無くて軽いのがベストなのでXfce4が良い。
</p>
<pre class="coding-env"><code>
// とりあえず、パッケージを更新
$ sudo pacman -Sy

// 必要なものをインストール
$ sudo pacman -S xfce4 xfce4-notifyd xorg-server xorg-xinit lightdm lightdm-gtk-greeter

// lightdmを有効にする
$ sudo systemctl enable lightdm

// 日本語入力に必要なものと好きなフォント
$ sudo pacman -S fctix-mozc fctix-im fctix-configtool noto-fonts noto-fonts-cjk noto-fonts-emoji
</code></pre>
<p>
　再起動してGUIのログイン画面が表示されればOK。フォントは入れなくてもいいが、もともと入ってるやつだと少し違和感がある。ログインしたらネットに繋いで、あとはどんどん必要なパッケージをインストールしていく。
</p>
<h4>インストールしたやつら</h4>
<ul style="list-style-type:none">
    <li>chromium：Webブラウザ</li>
    <li>thunderbird：Mailクライアント</li>
    <li>palseaudio：サウンドサーバ</li>
    <li>xfce4-palseaudio-plugin：pulseaudioのシステムトレイアイコン</li>
    <li>pavucontrol：GUIのボリュームコントロール</li>
    <li>xfce4-screenshooter：スクリーンショット</li>
    <li>htop：CLIリソース管理</li>
    <li>vlc：メディア再生</li>
    <li>libreoffice-still：オフィスソフト</li>
    <li>libreoffice-still-ja：libreoffice日本語化</li>
    <li>intellij-idea-community-edition：統合開発環境</li>
    <li>rust：プログラミング言語</li>
    <li>sshfs：ネットワーク越しにマウント</li>
    <li>gvfs：ゴミ箱を使うのに必要</li>
    <li>gvfs-backends：thunarでsambaを参照するのに必要</li>
    <li>gvfs-smb：こちらもsamba参照に必要</li>
    <li>network-manager-applet：システムトレイにネットワークのアイコン</li>
    <li>bluez-utils：bluetooth</li>
    <li>blueman：bluetooth関連ユーティリティー</li>
    <li>pacman-contrib：paccacheが使える</li>
</ul>
<p>
　日本語入力のためにfctixを使う設定を<code class="coding-env">~/.bash_profile</code>に書き込む必要がある。bluetoothとnetworkmanagerはsystemdで起動するようにしておく。あとの設定はだいたいGUIからできるので分かりやすい。
</p>
<pre class="coding-env"><code>
// fcitxを使う設定。
$ echo "export GTK_IM_MODULE DEFAULT=fcitx" > ~/.xprofile
$ echo "export QT_IM_MODULE DEFAULT=fcitx" >> ~/.xprofile
$ export "export XMODIFIERS DEFAULT=@im=fcitx" >> ~/.xprofile

// ネットワークとbluetooth
$ sudo systemctl enable NetworkManager
$ sudo systemctl enable bluetooth

// 一度再起動して日本語入力やネットワークが正常ならば終わり
$ reboot
</code></pre>
<p>
　東芝REGZAの３２インチテレビをモニターにしているので大きくて明るいし音も良いが、ちょっと眩しいのでダークテーマで使っている。コマンドラインのプロンプトやvimの設定は他のPCから持ってきた。あとは今後のパッケージ管理をできるだけ分かりやすくしたいので、aurヘルパーのyayとpaccacheを使うことにした。
</p>
    </div>
<!--ここまでがTOP-->
        </div>
    </body>
</html>
